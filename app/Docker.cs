using Newtonsoft.Json.Linq;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Crono
{
    internal class Docker
    {
        /*
         * varre os container analisando quais deles possuem o agendamento de tarefas cron do arquivo docker-compose.yml (servicosYaml)
         */
        public static List<Container> getContainersID(List<Container> containers, JArray runningContainers)
        {
            for (int i = 0; i < containers.Count; i++)
            {
                //Console.WriteLine("AQUI0! ->" + containers[0].serviceName);
                Container container = containers[i];
                for (int j = 0; j < runningContainers.Count; j++)
                {
                    try
                    {
                        JToken containerRunning = runningContainers[j];
                        string containerRunningName = containerRunning["Labels"]["com.docker.compose.service"].ToString();
                        string containerRunningID = containerRunning["Id"].ToString();

                        if (containerRunningName == container.serviceName)
                        {
                            containers[i].containerID = containerRunningID;
                        }
                    }
                    catch (Exception)
                    {

                    }
                }
            }
            return containers;
        }

        /*
         * consulta o docker buscando todos os containers de pé
         */
        public static JArray getContainersCreated()
        {
            //return JArray.Parse("[{\"Id\":\"4f763ee3be00295f7a9bd0e9e98e01290fa832f51caa48aad39e0e6494a33d79\",\"Names\":[\"/example-crono-1\"],\"Image\":\"crono\",\"ImageID\":\"sha256:b2770b0069f3c7f9c9f3295d0f74e6c8a667b3998c999e5ccfe641840bc8e31b\",\"Command\":\"dotnet Crono.dll\",\"Created\":1664665084,\"Ports\":[],\"Labels\":{\"com.docker.compose.config-hash\":\"94bf6f480ec8df6ab993063cfaca584c0c1d3fb51668824948c36c3ddeecf608\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:b2770b0069f3c7f9c9f3295d0f74e6c8a667b3998c999e5ccfe641840bc8e31b\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"example\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example/docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example\",\"com.docker.compose.service\":\"crono\",\"com.docker.compose.version\":\"2.6.0\"},\"State\":\"running\",\"Status\":\"Up 3 seconds\",\"HostConfig\":{\"NetworkMode\":\"example_default\"},\"NetworkSettings\":{\"Networks\":{\"example_default\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"9c8483ae285a6237075292461443a32ddf77778b527901bcba0e4375a71d3368\",\"EndpointID\":\"3fb7945471232f32d0d5d9b9bb8d834b12cb1d5f85a5d7854fbafcab01f4c39b\",\"Gateway\":\"192.168.80.1\",\"IPAddress\":\"192.168.80.4\",\"IPPrefixLen\":20,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:c0:a8:50:04\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example/docker-compose.yml\",\"Destination\":\"/app/docker-compose.yml\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/var/run/docker.sock\",\"Destination\":\"/var/run/docker.sock\",\"Mode\":\"ro\",\"RW\":false,\"Propagation\":\"rprivate\"}]},{\"Id\":\"3869c830effe174a5407b7b5965479bfa090183e38ecba19f79d174b7b40ccb9\",\"Names\":[\"/example-service2-1\"],\"Image\":\"postgres\",\"ImageID\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"Command\":\"docker-entrypoint.sh postgres\",\"Created\":1664662656,\"Ports\":[{\"PrivatePort\":5432,\"Type\":\"tcp\"}],\"Labels\":{\"com.docker.compose.config-hash\":\"94ad2211bcffaf3ff3ee2cbbdd31f3a91128ed23f384c6d0ecaa4edccf1277c8\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"example\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example/docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example\",\"com.docker.compose.service\":\"service2\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"@hourly\"},\"State\":\"running\",\"Status\":\"Up 1 second\",\"HostConfig\":{\"NetworkMode\":\"example_default\"},\"NetworkSettings\":{\"Networks\":{\"example_default\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"9c8483ae285a6237075292461443a32ddf77778b527901bcba0e4375a71d3368\",\"EndpointID\":\"db8c309697f8bfc8e9a42460505b8b1997e61c9b49399b065d9642244e6605a3\",\"Gateway\":\"192.168.80.1\",\"IPAddress\":\"192.168.80.6\",\"IPPrefixLen\":20,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:c0:a8:50:06\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"volume\",\"Name\":\"5e1695f09642ef0d9878eb57a899d315397f82e2379974c27b043458b10f1a8a\",\"Source\":\"\",\"Destination\":\"/var/lib/postgresql/data\",\"Driver\":\"local\",\"Mode\":\"\",\"RW\":true,\"Propagation\":\"\"}]},{\"Id\":\"27e6b779fc1607cded5a9f7db60431794953fe273806948d35a1c16452e1861a\",\"Names\":[\"/example-service1-1\"],\"Image\":\"postgres\",\"ImageID\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"Command\":\"docker-entrypoint.sh postgres\",\"Created\":1664662656,\"Ports\":[{\"PrivatePort\":5432,\"Type\":\"tcp\"}],\"Labels\":{\"com.docker.compose.config-hash\":\"2650e7441a439b8202c6cd8d9cb6320e792fed6411e95253e4d3820d82d7602c\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"example\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example/docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example\",\"com.docker.compose.service\":\"service1\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"* * * * *\"},\"State\":\"running\",\"Status\":\"Up 24 seconds\",\"HostConfig\":{\"NetworkMode\":\"example_default\"},\"NetworkSettings\":{\"Networks\":{\"example_default\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"9c8483ae285a6237075292461443a32ddf77778b527901bcba0e4375a71d3368\",\"EndpointID\":\"fc70cdf4ecd7595fbc87094c15024d3df7d7652c9907d88c3562197cbff7a866\",\"Gateway\":\"192.168.80.1\",\"IPAddress\":\"192.168.80.2\",\"IPPrefixLen\":20,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:c0:a8:50:02\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"volume\",\"Name\":\"4a5d9263ad34fd85bb63d513a5e8fcce2d37a633a8c635e0a6c5f39496b5e1d8\",\"Source\":\"\",\"Destination\":\"/var/lib/postgresql/data\",\"Driver\":\"local\",\"Mode\":\"\",\"RW\":true,\"Propagation\":\"\"}]},{\"Id\":\"d0d952e5f99c7fecfbec9ae6d817fec7d0aea771104d8c729821812b1dea770b\",\"Names\":[\"/example-service3-1\"],\"Image\":\"postgres\",\"ImageID\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"Command\":\"docker-entrypoint.sh postgres\",\"Created\":1664662656,\"Ports\":[{\"PrivatePort\":5432,\"Type\":\"tcp\"}],\"Labels\":{\"com.docker.compose.config-hash\":\"c1efbdb44cad0ce81e218cc659c956785cc8e234c1a3ffa5806e254506f587f7\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"example\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example/docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example\",\"com.docker.compose.service\":\"service3\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"5 0 * 8 *\"},\"State\":\"running\",\"Status\":\"Up 4 seconds\",\"HostConfig\":{\"NetworkMode\":\"example_default\"},\"NetworkSettings\":{\"Networks\":{\"example_default\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"9c8483ae285a6237075292461443a32ddf77778b527901bcba0e4375a71d3368\",\"EndpointID\":\"4179101e46df23ffeb10f5588f2640ce2d4f7ef63c09490e219a94fbd144b152\",\"Gateway\":\"192.168.80.1\",\"IPAddress\":\"192.168.80.3\",\"IPPrefixLen\":20,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:c0:a8:50:03\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"volume\",\"Name\":\"b97f3ce7ef3e80d9e66abfc7082f5607990b44416957156b884bb153daa534da\",\"Source\":\"\",\"Destination\":\"/var/lib/postgresql/data\",\"Driver\":\"local\",\"Mode\":\"\",\"RW\":true,\"Propagation\":\"\"}]},{\"Id\":\"941162311bdcac0a9d2439dddd0b494676182dc5de28295a815471babb9dff0d\",\"Names\":[\"/example-service4-1\"],\"Image\":\"postgres\",\"ImageID\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"Command\":\"docker-entrypoint.sh postgres\",\"Created\":1664662656,\"Ports\":[{\"PrivatePort\":5432,\"Type\":\"tcp\"}],\"Labels\":{\"com.docker.compose.config-hash\":\"b1a5a17ca52891a1ddd058b7d11860e24af162fe653d53eea927c02425566d97\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:b37c2a6c1506f32995fc6958c3642b1ccdf783b48d0add5027a3c3b884f41c0c\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"example\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example/docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/Chrono/Crono/example\",\"com.docker.compose.service\":\"service4\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"50-59 * * * 1-5\"},\"State\":\"running\",\"Status\":\"Up 2 seconds\",\"HostConfig\":{\"NetworkMode\":\"example_default\"},\"NetworkSettings\":{\"Networks\":{\"example_default\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"9c8483ae285a6237075292461443a32ddf77778b527901bcba0e4375a71d3368\",\"EndpointID\":\"f46c3c5130eed6dd854ca1efb74b11484c0b2dfdd47c5cd9428f9a2de734384a\",\"Gateway\":\"192.168.80.1\",\"IPAddress\":\"192.168.80.5\",\"IPPrefixLen\":20,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"02:42:c0:a8:50:05\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"volume\",\"Name\":\"3857b688fdee9e58831b2f5c9c2cc331ca9ab4ded65023e6ee68d9550ec1f0db\",\"Source\":\"\",\"Destination\":\"/var/lib/postgresql/data\",\"Driver\":\"local\",\"Mode\":\"\",\"RW\":true,\"Propagation\":\"\"}]},{\"Id\":\"58f7c004dbc8659bdc9c03b34848aa49bbc1b0a9ab5416164705361dcc29ae1f\",\"Names\":[\"/prime-bit\"],\"Image\":\"hudsonventura/plataforma:testing\",\"ImageID\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"Command\":\"/dockerstartup/vnc_startup.sh /dockerstartup/mt5setup.sh\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"any.accetto.description\":\"Headless Ubuntu VNC/noVNC container with Xfce desktop\",\"any.accetto.display-name\":\"Headless Ubuntu/Xfce VNC/noVNC container\",\"any.accetto.expose-services\":\"6901:http,5901:xvnc\",\"any.accetto.tags\":\"ubuntu, xfce, vnc, novnc\",\"com.docker.compose.config-hash\":\"6081aca4ba0f39dba79eb89327c5272709b7ffc58fb40bbb98e22493788721f3\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"hub:service_started\",\"com.docker.compose.image\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"prime-bit\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"0 0 1 * *\",\"maintainer\":\"https://github.com/accetto\",\"org.label-schema.vcs-ref\":\"\",\"org.label-schema.vcs-url\":\"https://github.com/accetto/ubuntu-vnc-xfce\",\"vendor\":\"accetto\",\"version-sticker\":\"\"},\"State\":\"exited\",\"Status\":\"Exited (137) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_trade\"},\"NetworkSettings\":{\"Networks\":{\"trade_trade\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"957fa4b4e7b88bf2c39b9b0b70c8bec5798e9a69a35ef19996f0406563242b72\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Presets\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Scripts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Scripts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/mt5setup.sh\",\"Destination\":\"/dockerstartup/mt5setup.sh\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Configs\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Experts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Experts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Include\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Include\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Libraries\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Libraries\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]},{\"Id\":\"baa81df83f297b6948691b3f84be60fcd971face3118b8c24267b808cf392978\",\"Names\":[\"/alpari\"],\"Image\":\"hudsonventura/plataforma:testing\",\"ImageID\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"Command\":\"/dockerstartup/vnc_startup.sh /dockerstartup/mt5setup.sh\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"any.accetto.description\":\"Headless Ubuntu VNC/noVNC container with Xfce desktop\",\"any.accetto.display-name\":\"Headless Ubuntu/Xfce VNC/noVNC container\",\"any.accetto.expose-services\":\"6901:http,5901:xvnc\",\"any.accetto.tags\":\"ubuntu, xfce, vnc, novnc\",\"com.docker.compose.config-hash\":\"267f06ede96e12ac4d3695d2a2494144027ebd0c37b799301551d56d62739cb4\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"hub:service_started\",\"com.docker.compose.image\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"alpari\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"0 0 * * 0\",\"maintainer\":\"https://github.com/accetto\",\"org.label-schema.vcs-ref\":\"\",\"org.label-schema.vcs-url\":\"https://github.com/accetto/ubuntu-vnc-xfce\",\"vendor\":\"accetto\",\"version-sticker\":\"\"},\"State\":\"exited\",\"Status\":\"Exited (137) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_trade\"},\"NetworkSettings\":{\"Networks\":{\"trade_trade\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"957fa4b4e7b88bf2c39b9b0b70c8bec5798e9a69a35ef19996f0406563242b72\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Presets\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Scripts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Scripts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/mt5setup.sh\",\"Destination\":\"/dockerstartup/mt5setup.sh\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Configs\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Experts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Experts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Include\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Include\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Libraries\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Libraries\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]},{\"Id\":\"78c4d43e5a596adc148a924189f148c90d4a04e7c796667381f849e27a8de71a\",\"Names\":[\"/genial\"],\"Image\":\"hudsonventura/plataforma:testing\",\"ImageID\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"Command\":\"/dockerstartup/vnc_startup.sh /dockerstartup/mt5setup.sh\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"any.accetto.description\":\"Headless Ubuntu VNC/noVNC container with Xfce desktop\",\"any.accetto.display-name\":\"Headless Ubuntu/Xfce VNC/noVNC container\",\"any.accetto.expose-services\":\"6901:http,5901:xvnc\",\"any.accetto.tags\":\"ubuntu, xfce, vnc, novnc\",\"com.docker.compose.config-hash\":\"2bb1296a13701e18b69e22b399c1bd011df47f769e99291616913b09e24b7462\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"hub:service_started\",\"com.docker.compose.image\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"genial\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"0 0 * * *\",\"maintainer\":\"https://github.com/accetto\",\"org.label-schema.vcs-ref\":\"\",\"org.label-schema.vcs-url\":\"https://github.com/accetto/ubuntu-vnc-xfce\",\"vendor\":\"accetto\",\"version-sticker\":\"\"},\"State\":\"exited\",\"Status\":\"Exited (137) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_trade\"},\"NetworkSettings\":{\"Networks\":{\"trade_trade\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"957fa4b4e7b88bf2c39b9b0b70c8bec5798e9a69a35ef19996f0406563242b72\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Presets\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Scripts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Scripts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/mt5setup.sh\",\"Destination\":\"/dockerstartup/mt5setup.sh\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Configs\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Experts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Experts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Include\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Include\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Libraries\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Libraries\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]},{\"Id\":\"ac011451545d7cf27ca835a4cf11fc86770888775875609f75414e333e1d3f9d\",\"Names\":[\"/rico\"],\"Image\":\"hudsonventura/plataforma:testing\",\"ImageID\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"Command\":\"/dockerstartup/vnc_startup.sh /dockerstartup/mt5setup.sh\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"any.accetto.description\":\"Headless Ubuntu VNC/noVNC container with Xfce desktop\",\"any.accetto.display-name\":\"Headless Ubuntu/Xfce VNC/noVNC container\",\"any.accetto.expose-services\":\"6901:http,5901:xvnc\",\"any.accetto.tags\":\"ubuntu, xfce, vnc, novnc\",\"com.docker.compose.config-hash\":\"66267eb45c09c4864380629f4487b9ed3d7f9e3aeb0274596b73ac2c67dcbaca\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"hub:service_started\",\"com.docker.compose.image\":\"sha256:abb5fefff3b16462a63e4387bcef398d405d18fd9a77bab0b6f3d3fd5d9274bb\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"rico\",\"com.docker.compose.version\":\"2.6.0\",\"crono\":\"* * * * *\",\"maintainer\":\"https://github.com/accetto\",\"org.label-schema.vcs-ref\":\"\",\"org.label-schema.vcs-url\":\"https://github.com/accetto/ubuntu-vnc-xfce\",\"vendor\":\"accetto\",\"version-sticker\":\"\"},\"State\":\"exited\",\"Status\":\"Exited (137) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_trade\"},\"NetworkSettings\":{\"Networks\":{\"trade_trade\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"957fa4b4e7b88bf2c39b9b0b70c8bec5798e9a69a35ef19996f0406563242b72\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Presets\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Scripts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Scripts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/mt5setup.sh\",\"Destination\":\"/dockerstartup/mt5setup.sh\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/plataformas\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Configs\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Experts\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Experts\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Include\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Include\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/Plataformas/MQL5/Libraries\",\"Destination\":\"/home/headless/.wine/drive_c/Program Files/MetaTrader 5/MQL5/Libraries\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]},{\"Id\":\"e72606253eb5f9f8f78971669818523b3251f61c6dc8e183153912a6b70d973c\",\"Names\":[\"/hub\"],\"Image\":\"hub\",\"ImageID\":\"sha256:d6608dfd07819e22d6ed6e9d2ae100fda5674c64e20dfc268e270e1e8431b69b\",\"Command\":\"dotnet Hub.dll\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"com.docker.compose.config-hash\":\"2f0bf770e4d83153ea40aa9ca8b46c02dd4872c55434cdddb386197398f32afc\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"db:service_started\",\"com.docker.compose.image\":\"sha256:d6608dfd07819e22d6ed6e9d2ae100fda5674c64e20dfc268e270e1e8431b69b\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"hub\",\"com.docker.compose.version\":\"2.6.0\"},\"State\":\"exited\",\"Status\":\"Exited (0) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_trade\"},\"NetworkSettings\":{\"Networks\":{\"trade_trade\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"957fa4b4e7b88bf2c39b9b0b70c8bec5798e9a69a35ef19996f0406563242b72\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/hub\",\"Destination\":\"/app/persist\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]},{\"Id\":\"611a8c4d121dded7cca2c0ee8f9fa4bdda4b337b40e9b012530558d58e07f882\",\"Names\":[\"/db\"],\"Image\":\"postgres:14\",\"ImageID\":\"sha256:75993dd36176c7d4be8c1e6d88a115f1fb35a85451088699dbdc80659ad688ed\",\"Command\":\"docker-entrypoint.sh postgres\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"com.docker.compose.config-hash\":\"c6e896aab85d0cd1cfa1863a4b4593d035bf33bdb6a080fa20dcc240e19cb7bc\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:75993dd36176c7d4be8c1e6d88a115f1fb35a85451088699dbdc80659ad688ed\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"db\",\"com.docker.compose.version\":\"2.6.0\"},\"State\":\"exited\",\"Status\":\"Exited (0) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_trade\"},\"NetworkSettings\":{\"Networks\":{\"trade_trade\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"957fa4b4e7b88bf2c39b9b0b70c8bec5798e9a69a35ef19996f0406563242b72\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/tmp/db\",\"Destination\":\"/var/lib/postgresql/data\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]},{\"Id\":\"5295e22de201ba3640da4b8283137ba47a7307af1b6f385da900a1957a32c1e2\",\"Names\":[\"/trade-crono-1\"],\"Image\":\"hudsonventura/crono:testing\",\"ImageID\":\"sha256:54fe5f391a1340a25c89110032084ab5d15ed333f88cc195ffcddecb8270d59a\",\"Command\":\"dotnet Crono.dll\",\"Created\":1664502236,\"Ports\":[],\"Labels\":{\"com.docker.compose.config-hash\":\"9c5cbf40a559e27a3d4b44ee20aad411fe7440f0f0859e4e892a0afd06e416c3\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.image\":\"sha256:54fe5f391a1340a25c89110032084ab5d15ed333f88cc195ffcddecb8270d59a\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"trade\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"com.docker.compose.project.environment_file\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/data/.env\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade\",\"com.docker.compose.service\":\"crono\",\"com.docker.compose.version\":\"2.6.0\"},\"State\":\"exited\",\"Status\":\"Exited (143) 50 minutes ago\",\"HostConfig\":{\"NetworkMode\":\"trade_default\"},\"NetworkSettings\":{\"Networks\":{\"trade_default\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"fca037a27d1454863dde23c13e8359aa13adbbcc33901f7ad504f3e545081da4\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/trade/docker-compose.yml\",\"Destination\":\"/app/docker-compose.yml\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"},{\"Type\":\"bind\",\"Source\":\"/var/run/docker.sock\",\"Destination\":\"/var/run/docker.sock\",\"Mode\":\"ro\",\"RW\":false,\"Propagation\":\"rprivate\"}]},{\"Id\":\"aacb43a239957ef3646a600cfca3f2321dbba8c8680051973ace66c9b9c94e3b\",\"Names\":[\"/crono_building\"],\"Image\":\"sha256:6ddc28c0557c63ead49970a9d0a4d232a3f17aab48622ace327bd51a5e77eb2d\",\"ImageID\":\"sha256:6ddc28c0557c63ead49970a9d0a4d232a3f17aab48622ace327bd51a5e77eb2d\",\"Command\":\"dotnet \r\nCrono.dll bash\",\"Created\":1664409812,\"Ports\":[],\"Labels\":{},\"State\":\"exited\",\"Status\":\"Exited (139) 2 days ago\",\"HostConfig\":{\"NetworkMode\":\"default\"},\"NetworkSettings\":{\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"f45e3d1dec6504daf161a4b0dfc18808fd6b9716f8a0306163a78e135c76b8c3\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[]},{\"Id\":\"28939cb994870a015a8aa6a393d190d4430febbb9842838fad3fa744153f3954\",\"Names\":[\"/priceless_einstein\"],\"Image\":\"sha256:577f9c40380b4bfa40ddd840dd12e300fd7a1a3e76a0d5e063312304d1fd58a3\",\"ImageID\":\"sha256:577f9c40380b4bfa40ddd840dd12e300fd7a1a3e76a0d5e063312304d1fd58a3\",\"Command\":\"/bin/sh -c 'dpkg --add-architecture i386 &&     mkdir -pm755 /etc/apt/keyrings &&     wget -O /etc/apt/keyrings/winehq-archive.key https://dl.winehq.org/wine-builds/winehq.key &&     wget -NP /etc/apt/sources.list.d/ https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/winehq-bionic.sources &&     apt update &&     apt install --install-recommends winehq-staging'\",\"Created\":1664318249,\"Ports\":[],\"Labels\":{\"any.accetto.description\":\"Headless Ubuntu VNC/noVNC container with Xfce desktop\",\"any.accetto.display-name\":\"Headless Ubuntu/Xfce VNC/noVNC container\",\"any.accetto.expose-services\":\"6901:http,5901:xvnc\",\"any.accetto.tags\":\"ubuntu, xfce, vnc, novnc\",\"maintainer\":\"https://github.com/accetto\",\"org.label-schema.vcs-ref\":\"\",\"org.label-schema.vcs-url\":\"https://github.com/accetto/ubuntu-vnc-xfce\",\"vendor\":\"accetto\",\"version-sticker\":\"\"},\"State\":\"exited\",\"Status\":\"Exited (1) 4 days ago\",\"HostConfig\":{\"NetworkMode\":\"default\"},\"NetworkSettings\":{\"Networks\":{\"bridge\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"4182b52cefa40cfe36fe4017c956797bc35ada37606521c377253095efcba6d3\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[]},{\"Id\":\"efa3d6cfc285b12c6aa456c4aec1e101047bad64b306729e41104a4c75dc5608\",\"Names\":[\"/controlefinanceiro_db\"],\"Image\":\"postgres:14\",\"ImageID\":\"sha256:75993dd36176c7d4be8c1e6d88a115f1fb35a85451088699dbdc80659ad688ed\",\"Command\":\"docker-entrypoint.sh postgres\",\"Created\":1664237809,\"Ports\":[],\"Labels\":{\"com.docker.compose.config-hash\":\"61eb4c14c29135a36b6cc427612f6591e1e364a69b89ed4b872360c87e04c624\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.depends_on\":\"\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"testesreact\",\"com.docker.compose.project.config_files\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/TestesReact/docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/mnt/c/Users/hudsonventura/source/repos/Dropbox/TestesReact\",\"com.docker.compose.service\":\"db\",\"com.docker.compose.version\":\"2.6.0\"},\"State\":\"restarting\",\"Status\":\"Restarting (1) 16 seconds ago\",\"HostConfig\":{\"NetworkMode\":\"testesreact_react\"},\"NetworkSettings\":{\"Networks\":{\"testesreact_react\":{\"IPAMConfig\":null,\"Links\":null,\"Aliases\":null,\"NetworkID\":\"c47d25a9ba42c3e1459956e20e1bfc852d2f40b09b095088758876ec1d4b2fa8\",\"EndpointID\":\"\",\"Gateway\":\"\",\"IPAddress\":\"\",\"IPPrefixLen\":0,\"IPv6Gateway\":\"\",\"GlobalIPv6Address\":\"\",\"GlobalIPv6PrefixLen\":0,\"MacAddress\":\"\",\"DriverOpts\":null}}},\"Mounts\":[{\"Type\":\"bind\",\"Source\":\"/home/hudsonventura/temp/bancotestes\",\"Destination\":\"/var/lib/postgresql/data\",\"Mode\":\"rw\",\"RW\":true,\"Propagation\":\"rprivate\"}]}]");
            string response = ExternalApp.run("curl", "--silent -XGET --unix-socket /var/run/docker.sock -H 'Content-Type: application/json' http://localhost/containers/json?all=1");
            response = response.Replace("{\"message\":\"page not found\"}", "");
            if (response == "") {
                throw new Exception("I ran curl but the response was empty");
            }

            return JArray.Parse(response);
            
        }

        public static void operateContainer(Container container, string command)
        {
            if (container.containerID == null) {
                string msg = $"Service {container.serviceName}: I cannot found the container ID";
                Console.WriteLine(msg, Console.typeMessage.FAIL);
                throw new Exception(msg);
            }

            //realiza o restart do container
            string retorno = ExternalApp.run("curl", $"--silent -XPOST --unix-socket /run/docker.sock -H 'Content-Type: application/json' http://localhost/containers/{container.containerID}/{command}");
            retorno = retorno.Replace("{\"message\":\"page not found\"}", "");
            if (retorno.Contains("No such container"))
            {
                string msg = $"Service {container.serviceName}: No such container. Service {container.serviceName}, ID: {container.containerID}";
                Console.WriteLine(msg, Console.typeMessage.FAIL);
                throw new Exception(msg);
            }

            if (retorno == "")
            {
                string msg = $"Service {container.serviceName}: The docker.sock did not repond some valid";
                Console.WriteLine(msg, Console.typeMessage.FAIL);
                throw new Exception(msg);
            }
            Console.WriteLine($"Service {container.serviceName}: Container restarted successfully", Console.typeMessage.SUCESS);
        }

        
    }
}
